

# 一、为什么要数据埋点

一款APP在开发完成后， 一定需要看数据，来分析用户量，访问量，点击量，转化率等等这些指标。

需要具备数据分析能力。

数据分析能力，主要是数据利用能力，利用数据的前提是有数据，并且在真正做数据分析的时候，经常会出现数据不足的情况，需要通过设计埋点去采集，当你有数据需求的时候，连需求都不知道怎么提，这岂不是产品经理最大的痒点。



埋点是目的导向。



 

了解用户行为，比如用户的使用习惯，用户的决策路径，用户的注意力分布……

掌握产品动向，比如产品用户量，产品所处的生命周期，目前的数据表现……

支持产品决策，比如新功能的上线，旧功能的迭代优化……

科学的diss神器，大家都懂。

## 1.1 没有进行埋点

如果我们没有进行埋点，但是想进行数据分析，我们可以统计哪些数据

首先想到和用户数相关的指标为：新增、活跃和累计。

新增用户：第__1__次启动应用的用户（卸载后重新安装，不会重新计算）。
活跃用户：当日活跃用户指当日启动过应用的用户。
累计用户：指截止到当前，启动过应用的所有独立用户。

以上3个指标，均可以采用设备号作为唯一标识。


用户数，是以当前手机的设备号为依据，因此不需要埋点就可以收集得到。


用户数，准确么？

答案是：不准确。


## 1.2 数据分析的步骤

梳理数据分析业务需求和埋点采集是数据分析的第一步，埋点需求梳理和埋点采集的好坏直接决定了后续的实施成本和效果呈现。

# 二、什么是数据埋点

埋点是数据采集器，也就意味着通过埋点数据后，可以构建任一用户的行为路径，从而分析出高频事件以及流失率等一系列比较核心的数据变化


埋点是指对目标事件进行捕获、处理和上报的相关技术及实施过程，其主要目的是实现用户对产品行为的监控与数据收集。



# 三、埋点前提

思考清楚有无埋点的必要，埋点的作用是为数据分析提供数据源。这些数据源往往需要组合运算才能得到数据结果，通常用于分析某个功能的使用情况。

 

很多问题不能或者没有必要通过埋点来证明，例如验证选品方向，通过统计平台提供每日新增与次日留存即可验证，没有必要使用埋点进行细致的分析。

 

如果确定使用埋点，则要明确待验证的核心问题，建议先理清产品方案的相关流程，并且明确定义每个模块的核心指标。

# 四、埋点可以做什么

1. 埋点能够得到想要的数据解决/支持；

2. 能够得到当前版本的复盘情况；

3. 后续版本的数据支撑。



## 4.1 埋点能够得到想要的数据解决/支持



 （1）功能分析；（2）业务分析；（3）用户信息；（4）错误日志（这个数据目标只针对开发，不作为核心目标考虑）

 

功能分析：主要检验功能的受欢迎程度。

业务分析：事件转化、页面访问路径。

用户信息：用户画像。





功能流程转化率：关键业务的留存转化指标尤为重要，用户在哪个关键节点发生了流失，

 

改版调整：如果产品做了改版，肯定会在一些关键入口进行了布局上的优化，那么埋点统计有利于收集变化前后的不同。产品是否更加聚焦的解决了用户的痛点，还是

 

用户轨迹：用户来到了你的产品，第一件事情是做什么，然后还会做什么。如果你的产品，满足了用户的需求，那么主要路径我们是可以猜测得到的。但唯独那么一小块路径，是否会挖掘出更深层次的需求。



## 4.2 当前版本的复盘情况：

 

新版本功能使用情况，是否符合预期；

新功能上线后对其他功能点的影响？是否为整体均有积极作用；

版本运营活动目标群体的特征获取;

新增商业化目标的监测……

## 4.3 后续版本的数据支撑

规划方向的用户行为分析

画像特征分析

# 五、如何实现埋点

具体来说就是在定义的事件代码中植入一段监控代码，用户一旦触发该事件就会上报埋点代码中定义的需要上报的字段信息；通俗的说就是实现了给每个用户在使用自家产品时分配了一个产品经理，用来记录用户都打开了哪些页面，点击了哪些按钮，停留了多长时间。

明确了要验证的指标（北极星指标、方向指标、负面指标和行为指标），方向指标和负面指标是我们的项目中的关键指标，通过埋点验证这两个项目指标，这就是我们的需求。

无论是网站、客户端，还是APP应用，都可以从所谓的战略层、范围层 、结构层、框架层、表现层五个维度来分析。



埋点的基本流程包括如下几步：

 

整理埋点方案；

埋点代码植入；

埋点测试；

线上数据跟踪。



## 5.1 设计埋点的时机

 

在产品规划时就要思考数据埋点问题，如果在产品外发后再考虑怎么埋点，就会导致前期版本用户的数据无法收集，想要看某个数据时就会非常无奈，只有等到新版本完善来弥补。



## 5.2 埋点思路

 

想验证什么 → 明确分析思路 → 梳理埋点，就明确了我们的埋点需求，接下来就要把我们的埋点表达出来。







## 5.3 埋点原则

没有需求就别加，既能解决问题，又不浪费资源是最好的平衡点。

思考要埋哪些点、埋点的形式，需要紧密结合产品迭代的方向、运营需求，并和数据开发等进行充分沟通以确认。



## 5.4 4W1H

who

 

设备区分

账号区分

设备区分多用于不需要登录的产品，通过设备独有的编码来标记用户。账号区分是常用的方式，通过账号id、手机号等信息来标记用户。

 

when

 

设备时间

服务器时间（时间戳）

设备时间可能会因为不同时区的原因，用户之间各不相同，比如跨国业务，需要分析用户的使用时间分布，北京的白天就已是美国的深夜，通过设备时间分析会更方便，北京的8:00不是美国的8:00，但都是早晨。

 

服务器时间就是常说的Unix时间戳，是全球统一时间，不受时区的干扰，如果不考虑业务特殊情况，一般都是使用服务器时间。

 where

 

GPS定位

IP判断

常用的就是获取用户的定位权限，然后通过gps进行定位，还有就是通过设备ip判断用户位置。



what

 

商品下单（事件）

商品ID（属性）

期望收货时间

快递方式

商品退货

商品ID

退货原因

退货价格

商品是否已寄回

what就要看业务行为了，举了上面两个例子，并引入了“事件”和“属性”两个概念，事件是指具体的行为，属性是指行为相关的一些信息，如商品下单这个事件：

 

商品ID属性用来分析什么商品卖的好；

期望收货时间的属性用来分析物流方面的高峰期；

快递方式用来判断哪个合作物流对用户服务质量更好。

这个要根据不同的业务需要，在埋事件的同时，增加必要的属性，以便深入分析数据。



how

 

操作系统

设备品牌和型号

运营商

屏幕尺寸

用户来源等等

用户是怎么完成这个行为的，像上述这些信息都算，不止于此，看业务需要，可以继续扩充。




# 六、分析埋点数据

## 6.1 分布分析

 

通常用于分析一个行为的在某个维度的分布情况，如美团外卖APP，点外卖这个行为，一天24h的下单量分布，来确定运力（骑手）高峰期。

 

## 6.2 多维度拆解

 

通常用于定位问题原因，如摩拜APP12月份使用人数暴跌，通过地区、版本等不同维度拆解，发现只有东北地区的使用数据暴跌，因为12月处于冬季，大冬天的东北，你想想骑车不得冻死手啊，这就找到了原因。

 

## 6.3 漏斗分析

 

评估一个使用路径的流畅程度，比如电商下单流程的转化率。

 

## 6.4 路径分析

 

分析用户的流向和路径，比如从首页开始，有多少去了商品详情页，然后又有多少去看李佳琪直播了，接着又去了哪里。

 

## 6.5 留存分析

 

留存的定义有很多：活跃留存、新增留存和精准留存。精准留存较少被提及，精准留存可以更好地评估功能价值，比如进过李佳琪直播间的用户列为精准用户，那这部分用户之后的留存情况，就一定程度反映了李佳琪对这个平台的影响效果了。

 

## 6.6 粘性分析

 

评估一个功能对用户的粘性，比如一个月内进李佳琪直播间29天，那这个用户粘性达到了29次/月，粘性很高，就是李佳琪的忠实粉丝无疑了（OMG，买ta！！哈哈）。

## 6.7 对比分析

 

通常用于对比前后变化，比如功能上线前后日活人数对比。

 

# 七、埋点的方式

埋点分为“前端埋点”和“后端埋点”两种，前者是记录用户在客户端的使用数据，包括但不限于网页，APP，PC客户端等等，而后端埋点主要是记录程序接口的调用情况，例如接口访问次数，接口返回各个状态次数的统计等等。

 

产品经理通常说的埋点文档指的是前端埋点文档，前端埋点的优势是可以事无巨细的统计到用户的行为数据，但前端埋点为了性能考虑，并不会实时上报数据，所以注定了前端埋点的数据在时效性和准确性上不会做到100%精准无误。

 

如果希望统计的数据是实时且精准的，则往往采用接口将数据在指定的触发条件下上报至服务器，这时候就需要后端埋点来进行统计了。

## 7.1 客户端埋点&服务端埋点的优缺点

### 7.1.1 客户端埋点

优：搜集页面展示、点击行为，不需要请求服务器的数据

缺：无网络时数据不完整、实时性有延迟；当需要改变埋点时，必须更新版本。



前端埋的弊端

需要发版，出现问题时调整不及时且成本高

影响性能，影响用户体验（微乎其微的那种）

数据不足，相比于后端数据量少，脱离用户使用层的数据缺失

### 7.1.2 服务端埋点

优：（1）实时性好，数据准确；（2）变更成本低；（3）能够收集不在APP内发生的行为，只要请求服务器就行。如统计从其他APP引流的安装量。

缺：不能收集不需要请求服务器的数据；用户不联网不能采集数据



后端埋的弊端

不易验证前端页面设计效果，诸多交互行为不易记录

也会出现数据不足，比如页面停留时长等数据，需要前端专门提供

# 八、如何写数据需求文档（DRD）



通常的沟通过程以 埋点文档为载体；数据埋点评审为终结。



DRD所需信息：

 

事件位置 ———— 所在页面

事件英文变量 ——– 驼峰命名法（可自行百度了解）

事件名称 ———— 中文名称

事件定义 ———— 统计的是什么行为的什么数据

属性英文变量 ——– 驼峰命名法

属性名称 ———— 中文名称

属性值类型 ———– 数据类型：字符串，数值型等

属性定义 ———— 属性取值来源是哪，或者上报的值是哪些

上报时机 ———— 就是上面说到的啥时候上报

添加版本 ———— 哪个版本添加的埋点

备注 —————— 一些需要的备注信息

和PRD一样，也是团队内部信息传达和留存的重要文档，需要做到完整且清晰易懂



表格列表字段：页面位置、线索名称、事件名称、事件类型、事件ID、Key、value、采集时机、备注

 

（1）线索名称：线索就是追踪用户行为的记录，一个线索可以由多个事件组成。

 

举例：直播教室线索：进入教室、退出教室，这两个事件都能组成直播教室的线索。

 

（2）事件名称：说明该埋点的位置和功能

 

（3）事件类型：点击事件/浏览事件

 

（4）事件ID：事件类型_哪一端产品_页面名称_功能名称

 

举例：点击事件_APP端_直播教室_举手=btn_APP_classroom_hand

 

（5）key：参数，根据不同维度来计算。

 

举例：举手按钮，每个教室都有一个举手按钮，但点击的时候需要知道是各个班班的点击情况各个课节的点击情况各个学生点击的情况。

 

那就需要设计3个key：课节id,班级id,课节id,学生id。

 

（6）value：与key是一组，key-value，是一种数据模型方法。上面举例的3个key对应的value，分别就是各自的id值

 

（7）采集时机：说明触发埋点的具体操作行为

 

（8）备注：有特殊情况的单独备注，比如上台按钮的埋点，只有APP的iphone、Android有，iPad没有。另外新增的埋点，删除的埋点时间记录都需要备注清楚。

 

同一属性的事件只要设置不同key来区分就行。

 

如登录事件，用户可能从密码登录或验证码登录入口登录进去的，这个时候并不需要对每个页面的登录事件进行埋点，只需对登录一个点击事件埋点，key=入口类型，value=pwd/mes







包括以下几点内容：

 

埋点位置：即需要添加埋点相关信息的位置，比如页面上的按钮，搜索结果的每一个卡片，推荐位上的每一个卡片，每一个曝光区域等等；

埋点标识：每一个位置上面需要设置一个埋点的标识来代表这个点击位，类似代码里面的变量名，必须是全站唯一的，不能出现重复；

埋点参数：是指你想要在用户到达这个位置or页面，或者点击这个位置的时候，除了正常的流量数据（pv，uv），还想看到那些数据；

页面名称：是指当前埋点所属的页面，有这个才能定位到当前埋点是属于哪个页面的数据；

应用标识：是指当前应用的唯一标识，有的也叫站点。用来进行数据归属划分。

 

 

 

产品的埋点方案通常由产品经理来进行梳理，梳理完毕之后需要协同数据的同事进行确认，核对，保证方案的可行性。

 

 

 

引没引，埋没埋，报没报，落没落。

 

引：是指埋点代码是否引入，引入的代码是否与当前产品形态吻合；

埋：是指是否产品的所有模块都添加了埋点；

报：是指埋点之后数据是否能够正常上报；

落：是指上报的数据最后是否落到了对应的表里面。

# 九、埋点类型



\1. 状态事件与频次事件

状态事件：对于状态事件，频次是没有参考价值的，只有事件的最终状态才有价值

 

例如开关的开启与关闭，在指定的时间段，我们只关心开关的最终状态，至于期间开关了多少次，没有实际的统计意义。对于状态事件，我们一般用『用户属性』来表示。

 

但是对于很多统计平台，用户属性存在数量限制，所以对于颗粒度很小，并且操作可能非常频繁的状态事件来说，也可以通过事件数的大小进行粗略判断。例如，音乐应用中，通常会使用该音乐的收藏按钮的点击次数来判断音乐的受欢迎程度。

 

频次事件：频次事件就是普通的统计事件，例如按钮控件的点击事件，页面的展示事件。我们可以通过事件的频次，判断对应功能的价值。

 

 

\2. 具体事件与抽象事件

具体事件： 指的是某个具体操作，例如按钮的点击、页面的展示、弹窗的弹出等。

抽象事件： 往往指一类事件的集合，例如计算模块之间的漏斗转化率，往往会用到抽象事件，具体案例在下文会给出。

 

 

\3. 主动事件与被动事件

主动事件： 需要用户主动触发，例如按钮的点击，或者tab的切换，主动事件代表了用户的主动意愿，对于用户行为分析具有很大的参考意义。

被动事件： 不能表明用户的使用意愿，往往是用户操作的附加结果。例如，用户点击back键退出当前页面A，回到上一个页面B，此时上一个页面B的展示并不一定是用户真的想要进入，只是退出页面A的必经路径而已。这类事件对于用户的行为分析意义不是很大，但是对于其他维度的分析有着一定的参考价值，例如广告展示等。

 



## 9.1  点击事件

只要用户点击一次就计一次，不论点击的结果是否成功。（点击事件包含单击、双击、拖拽等交互事件）

 

举例：登录按钮的点击量≠登录成功后的页面曝光量。

 

点击登录后，会因为密码错误、账号错误等原因造成登录失败，无法进入登录成功后的页面。

 

1) 点击事件

 

用户在应用内的每一次点击行为，都可以记为一次点击事件。比如按钮的点击，区域的点击，商品的点击，每一条新闻的点击等，都可以成为一个点击事件。

 

一般通过点击事件，我们可以拿到点击PV，点击UV。

## 9.2 曝光事件

浏览事件的定义要根据不同需求自定义。

 

比如成功打开一次页面计一次，页面停留超过10s等，我是以成功加载出来就计1次曝光事件。

 

ps：友盟自带的页面统计与自定义事件的页面访问量并不同哦！

 

2) 曝光事件

 

曝光事件是为了统计应用内的某些局部区域是否被用户有效浏览。比如推荐区域，某个按钮，首焦等等。

 

比如一般来说我们在衡量页面某个区域用户的点击率的时候，首先需要搞清楚的就是这个区域到底被多少用户看到了，每被用户看到一次就是一个简单的曝光事件，然后才能计算点击率。

 

做曝光埋点的时候需要注意两个事情：第一，有效曝光的定义要科学，合理；第二，为了不影响页面性能以及用户体验，不能在应用内的所有区域都加曝光埋点。

 

曝光埋点是一个非常有意思的东西，也有很多知识、细节在里面，做好曝光埋点不容易，我打算以后单独写一篇文章来讲。

 

## 9.3 页面事件

3）页面事件

 

页面事件通常是指页面的各种维度信息的统计。常见的比如页面浏览PV，页面浏览UV。

 

页面事件通常统计的信息包括以下几个部分：

 

浏览器信息：浏览器版本，浏览器语言，浏览器编码，屏幕分辨率等等；

访问信息：用户账号，当前页面url，上次访问时间，访问时长，页面停留时间等等；

来源信息：广告来源，上一页面url等等；

物品信息：不同的业务，这部分信息区别很大。

 # 十、埋点的技巧和注意事项



 

## 10.1 验证埋点对不对

看本次埋点是否正确以外，一定要验证其他相关埋点是否正确，不确定会影响哪些埋点的话可以提前和开发哥哥沟通代码影响面，因为可能会在增加埋点的时候涉及了其他埋点的代码，导致埋点上报错误。

 

想清楚为什么埋，梳理好埋点需求

说明白要怎么埋，写清楚埋点文档

验证埋点对不对，相关埋点也要验











a.漏斗分析要闭环

 

这也是《如何用数据驱动产品迭代》中讲过的，不赘述了。

 

b.上报时机要准确

 

一个行为的发生要经历事件触发（前端） → 数据入库（后端） → 事件发生（前端）的过程，以电商购买这个操作为例，点击购买按钮（事件触发） → 后端验证库存等信息后返给前端结果（数据入库） → 跳转到下单页（事件发生）。

 

我们应该选哪个环节上报呢？高精度的埋点需求建议如下：

 

后端埋点：数据入库环节，数据入库时上报

前端埋点：事件发生环节，收到后端返回结果时上报

以上这两种方式可以保证数据结果的准确性，我们也会有一些低精度的埋点需求，比如只想大致了解一下页面各按钮和操作的使用情况，可以采用事件触发环节上报。



c.事件要尽量合并

 

出于维护和使用方便的考虑，能用属性解决就不要徒增事件。

 

还是以商品下单流程为例，我们想验证直播带货的能力，就需要区分直播间下单和普通浏览下单，有以下两种方案：

 

方案1：两种下单方式各埋一个点，也就是两个下单成功事件。

方案2：只埋一个点，一个下单成功事件，然后增加一个“下单来源”的属性，属性值分别是“直播间下单”和“普通浏览下单”。

从埋点的简洁性和易用性来看，第二种方案是更好的，便于分析的同时，避免了埋点的臃肿。就像写代码一样，很多种写法都能实现需求，但是三行代码就是比三十行代码优秀！

 

d.抽离出公共属性

 

在上面的“who when where how what”中，罗列了很多埋点信息，其中有些属性是很多事件中都会用到的，比如用户身份是否vip、省份，以及使用的设备型号和操作系统，这些属性我们可以抽离出来作为公共属性，不需要每个事件都单独上报这些属性，统一上报，这样做了之后，追求代码效率的开发哥哥肯定会喜欢你的。

 

一些不常用的属性就不要抽离出来了，比如商品退货行为中的“退货原因”这个属性，只有在退货这一个行为中有，在其他地方都是用不到的，所以在退货事件上单独上报更合适。